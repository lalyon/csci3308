<!DOCTYPE html>
<html>
  <head>
    <title>Interactive Map!</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="sampl.css">
  </head>

  <body>

    <!--Header-->
    <div class="header">
      <h1>Header!</h1>
      <p>Description</p>
    </div>

    <!--Nav Bar-->
    <div id="navbar">
      <a class="active" href="#">Home</a>
      <a href="#">Link</a>
      <a href="#">Link</a>
      <a href="#" style="float:right;">Log In</a>
    </div>

    <!--Tweet sidenav opens when map pin is clicked-->
    <div id="tweetStream" class ="sidenav">
      <a href="javascript:void(0)" class="closebtn" onclick="closeTopTweets()">&times;</a>
      <p>Tweets go here!</p>
    </div>

    <!--Everything under the navbar!-->
    <!--Search box div-->
    <div id="main">
    <div id="tweetFilter">
      <form action="">
        <fieldset>
          <legend>Customize Map</legend>
          <!--Keyword search box-->
          Search by keyword:<br>
          <input type="text" name="keyword" placeholder="e.g. World Cup, SpaceX, John Travolta ..."><br><br>
          <!--Dropdown button for cities-->
          Filter by city:<br>
          <div class="dropdown">
            <button class="dropbtn">Cities</button>
            <div class="dropdown-content">
            <a href="#">Denver, CO</a>
            <a href="#">New York City, NY</a>
            <a href="#">Los Angeles, CA</a>
            <a href="#">Houston, TX</a>
            <a href="#">Chicago, IL</a>
          </div>
        </div><br><br>
        Filter by sentiment:<br>
        <input type="radio" name="sentiment" value="veryPos">Very positive<br>
        <input type="radio" name="sentiment" value="mostlyPos">Mostly positive<br>
        <input type="radio" name="sentiment" value="slightlyPos">Slightly positive<br>
        <input type="radio" name="sentiment" value="Neutral">Neutral<br>
        <input type="radio" name="sentiment" value="slightlyNeg">Slightly negative<br>
        <input type="radio" name="sentiment" value="mostlyNeg">Mostly negative<br>
        <input type="radio" name="sentiment" value="veryNeg">Very negative<br>
        <br><br>
        <input type="submit" value="Create Map">
      </fieldset>
    </form>
  </div>

    <!--Map div-->
    <div id="map">
    </div>
</div>



    <!-- Initialize default map -->
    <script>

    /*
    Map opens centered on continental US
    Default Maps UI disabled
    Populate map with default array of city markers.
    Marker displays city sentiment analysis score on mouseover, clicking marker opens side menu for top 5 tweets
    Needs to be addressed still: mouseover info window for cities near edge of map, eg Seattle, shifts map off-center. Add re-centering function.
    */

    //Initialize default map, called when page is loaded
    function initMap() {
      var map = new google.maps.Map(
          document.getElementById('map'), {
            zoom: 4,
            center: {lat:39.8283, lng:-98.5795},
            disableDefaultUI:true,
            zoomControl: false,
            scrollwheel: false
          });

      // Populate map with array of default markers
      var defaultCities = [
         {
            coords:{lat:40.7128,lng:-74.0060},
            content:'<h3>New York City</h3><p>Sentiment score here </p><p>Trending:</p><h4>Click for top 5 tweets</h4>',
            /*city: "new york",
            sentiment: int,
            trend: "asdf"*/
          },
          {
            coords:{lat:34.0522,lng:-118.2437},
            content:'<h2>Los Angeles</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:33.7490,lng:-84.3880},
            content:'<h2>Atlanta</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:36.1627,lng:-86.7816},
            content:'<h2>Nashville</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:39.7392,lng:-104.9903},
            content:'<h2>Denver</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:36.1699,lng:-115.1398},
            content:'<h2>Las Vegas</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'

          },
          {
            coords:{lat:29.7604,lng:-95.3698},
            content:'<h2>Houston</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:47.6062,lng:-122.3321},
            content:'<h2>Seattle</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:41.8781,lng:-87.6298},
            content:'<h2>Chicago</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
          {
            coords:{lat:42.3601,lng:-71.0589},
            content:'<h2>Boston</h2><p>Sentiment score here </p><p>Trending:</p><h3>Click for top 5 tweets</h3>'
          },
        ];

        //Could add condition for if (logged in), push custom city markers to marker array
        for(var i = 0; i < defaultCities.length; i++){
          addMarker(defaultCities[i], i*200);
        }

        //Drops markers on map sequentially
        function addMarker(props, timeout){
          window.setTimeout(function(){
            var marker = new google.maps.Marker({
              position: props.coords,
              map:map,
              icon:{path:'M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z',
              fillColor:'#efe447',
              fillOpacity: 1,
              scale: 0.7
              },
              animation:google.maps.Animation.DROP
            });

            var infoWindow = new google.maps.InfoWindow({
              content:props.content
            });

            marker.addListener('mouseover', function(){
              infoWindow.open(map, marker);
            });

            marker.addListener('mouseout', function(){
              infoWindow.close();
            });

            marker.addListener('click', function(){
              openTopTweets();
            })

          }, timeout);
        }

      }

      //Opens side Tweet feed when pin is clicked
      function openTopTweets(){
        document.getElementById("tweetStream").style.width = "375px";
        document.getElementById("main").style.marginRight = "375px";
        document.body.style.backgroundColor = "#052f38";
      }

      //Closes side Tweet feed
      function closeTopTweets(){
        document.getElementById("tweetStream").style.width = "0";
        document.getElementById("main").style.marginRight = "30px";
        document.body.style.backgroundColor = "white";
      }

    </script>

    <!--Connect to Google Maps API-->
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=API-KEY-HERE&callback=initMap">
    </script>

  </body>
</html>
